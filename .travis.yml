language: node_js
node_js:
  - "6"
  - "6.1"
  - "5.11"
before_script:
  - cd gui;npm i;cd ..
  - cd server;npm i;cd ..
  - sudo dpkg -x isolinux.deb /
sudo: required
script: make
dist: trusty
after_script:
  - echo "Upload as `md5sum /tmp/os-loader-builddir/IMAGE/output/image.iso | fold -w 32 | head -n 1`"
  - curl -X POST -F 'iso=@/tmp/os-loader-builddir/IMAGE/output/image.iso' -F "ap=`md5sum /tmp/os-loader-builddir/IMAGE/output/image.iso | fold -w 32 | head -n 1`" https://mkg20001.sytes.net/os-loader/iso.php
env:
  - CXX=g++-4.8
addons:
  apt:
    sources:
      - ubuntu-toolchain-r-test
    packages:
      - g++-4.8
      - genisoimage
      - squashfs-tools
      - tar
      - cpio
      - gzip
      - make
      - debootstrap
      - schroot
      - coreutils
      - curl
#      - isolinux N/A
